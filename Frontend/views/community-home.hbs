<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    {{!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"> --}}
    <link rel="stylesheet" href="https://unpkg.com/boxicons@latest/css/boxicons.min.css">
    <link href="https://cdn.jsdelivr.net/npm/remixicon@2.5.0/fonts/remixicon.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="https://demo.plantpot.works/assets/css/normalize.css">
    <link rel="stylesheet" href="https://use.typekit.net/opg3wle.css">
    <link rel="stylesheet" href="/css/community-home.css">
    <title>CDTI Communtity Board</title>
</head>
<body>

    <header>
        <div class="logo">
            <i class="ri-community-line"></i>
            <span>CDTI Community Board</span>
        </div>
        

        <ul class="navbar">
            
            <li>
                <a href="/">
                <i class="ri-home-fill"></i>
                <span class="navtext">   Home</span>
                </a>
            </li>
            {{!-- <li>
                <a href="/chat">
                <i class="ri-message-2-fill"></i>
                <span class="navtext">   Chat</span>
                </a>
            </li> --}}
            <li>
                <a href="/post">
                <i class="ri-chat-upload-fill"></i>
                <span class="navtext">   Post</span>
                </a>
            </li>
            <li>
                <a href="/logout">
                <i class="ri-logout-box-fill"></i>
                <span class="navtext">   Log out</span>
                </a>
            </li>

        </ul>

        <div class="account">
            <a href="/profile/{{ userid }}" class="user"><i class="ri-account-circle-fill"></i></a>
            <div class="bx bx-menu" id="menu-icon"></div>
        </div>
        
    </header>

    <main>

        <div class="greetings-box">
            {{#if userid}}
                <p class="user">Welcome, {{ account.name }}</p>
                <p class="greetings">Enjoy. Our community. Please use as polite as you can.</p>
            {{else}}
                <p>You are not logged in</p>    
            {{/if}}
        </div>
        
        {{#if contents_data}}
        
            {{#each contents_data}}
            <div class="post-container">
                {{!-- {{#each blogs}} --}}
                    <div class="post-box">

                        <div class="content-text">
                            <div class="profileBox">

                                <div class="profilepicture">
                                    <img src="{{avatar}}" alt="">
                                </div>
                                <div class="profileinfo">
                                    <p class="name">{{name}}</p>
                                    <p class="time">posted on  {{date}} at {{time}}</p>
                                </div>

                            </div>
                            <p class="contents">{{content}}</p>
                        </div>

                        <p>{{_id}}</p>
                        

                        <div class="content-img">
                            <img src="{{img}}">
                        </div>

                        <div id="Allcomments">

                            {{!-- <div class="each-comment">
                                <div class="user-comment">
                                    <div class="avatar-comment">
                                        <img src = "https://sv1.picz.in.th/images/2023/02/15/L6B2Xu.png">
                                    </div>
                                    <div class="comment-data">
                                        <p>Name</p>
                                        <p></p>Lorem ipsum dolor sit amet consectetur adipisicing elit.</p>
                                    </div>
                                </div>
                            </div> --}}

                        </div>
                        
                        <form id="commentForm" action="/comment" method="post">
                            <input type="submit" value="post">
                            {{!-- <div class="comment">
                                <input type="text" name="comment" placeholder="Add a comment ...."> --}}
                                {{!-- <button type="submit" value="Post" style="width: 100px; height: 100px;"></button> --}}
                                    {{!-- <i class="ri-arrow-right-circle-fill"></i>
                                </button>
                            </div> --}}
                        </form>
                        
                    </div>
                {{!-- {{/each}}   --}}
                </div>
            {{/each}}
            
        {{else}}
            <p>No posts yet.</p>    
        {{/if}}    
    </main> 

    {{!-- <footer>
        <p>Please contact us 095-573-9706</p>
    </footer> --}}
    <script>
        document.getElementById("commentForm").addEventListener("submit", function(event) {
            event.preventDefault(); // Prevent default form submission
            const formData = new FormData(event.target); // Get form data
            const comment = formData.get("comment"); // Get comment text
            fetch("/comments", {
                method: "POST",
                body: JSON.stringify({ comment }),
                headers: { "Content-Type": "application/json" }
            })
            .then(response => response.json())
            .then(data => {
                const commentDiv = document.createElement("div");
                commentDiv.textContent = data.comment;
                document.getElementById("comments").appendChild(commentDiv);
                event.target.reset(); // Clear form after successful submission
            })
            .catch(error => console.error(error));
        });
    </script>
    
    
</body>
</html>